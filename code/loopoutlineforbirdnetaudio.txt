#---- big loop
location <- list.files(year) #only takes year, because it's looking for the year folder in the AudioMoth files

#let's initialize all the variables we'll use to hold information in the for loops, that we'll need at the individual audiofile level
date = "blank"
filename = "blank"
newfilename = "blank"
time = "053000"

#in the for loops: [a] is location, [b] is stakes, [c] is audiofile

#starting for loop, get location
for(a in 1:length(location)){
  
  #save names of stakes in that location
  stakes <- list.files(paste(year, location[a], sep="/"))
  
  #look at list of stakes
  for(b in 1:length(stakes)) {
    
    #get list of audio files in that stake
    stakeaudiofiles <- list.files(paste(year, location[a], stakes[b], sep="/"))
    
    #now, let's loop through and rename audio files
    for(c in 1:length(stakeaudiofiles)) {
      
      #get current file name
      filename <- stakeaudiofiles[c]
      #pull the date from the file name
      date <- str_sub(filename, start = 1, end = 8)
      if (str_sub(filename, start = 10, end = 15) == "093000" || str_sub(filename, start = 10, end = 15) == "053000"){
      #create the new file name !NOTE: does not include .wav
      newfilename <- paste(location[a],stakes[b],date, time, sep = "_")
      #rename the file
      file.rename(from = paste(paste(year,location[a],stakes[b],sep="/"), "/", filename, sep = ""), to = paste(paste(year,location[a],stakes[b],sep="/"), "/", newfilename, ".wav", sep = ""))}
      else {}#do not change time because it did not record at the right time (9:30 UTC, 5:30 EST)
    }
    stakeaudiofiles <- list.files(paste(year, location[a], stakes[b], sep="/"))
    for(e in 1:length(stakeaudiofiles)){
      if (str_sub(stakeaudiofiles[e], start = 1, end = 3) != "Big" && str_sub(stakeaudiofiles[e], start = 1, end = 3) != "Wes"){
        print(paste("error", stakeaudiofiles[e], year, location[a], stakes[b], sep=" "))
  }
    }
  }
}
